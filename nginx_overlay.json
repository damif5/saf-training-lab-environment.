{"platform":{"name":"debian","release":"11.6","target_id":"e27fc6eb-32f8-5b64-ae9b-898b73b51def"},"profiles":[{"name":"my_nginx_overlay","version":"0.1.0","sha256":"357123c1c9cd7af0ed65a52fb670a6b596ae2cbd6597d0159e490799eca181bf","title":"InSpec Profile","maintainer":"The Authors","summary":"An InSpec Compliance Profile","license":"Apache-2.0","copyright":"The Authors","copyright_email":"you@example.com","supports":[{"platform":"os"}],"attributes":[],"depends":[{"name":"my_nginx","path":"../my_nginx","status":"loaded"}],"groups":[{"id":"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb","controls":["nginx-version","nginx-modules"]}],"controls":[{"id":"nginx-version","title":"NGINX version","desc":"The required version of NGINX should be installed.","descriptions":[{"label":"default","data":"The required version of NGINX should be installed."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-version' do\n  impact 1.0\n  title 'NGINX version'\n  desc 'The required version of NGINX should be installed.'\n  describe nginx do\n    its('version') { should cmp >= input('nginx_version') }\n  end\nend\n","source_location":{"line":1,"ref":"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb"},"waiver_data":{},"results":[]},{"id":"nginx-modules","title":"NGINX modules","desc":"The required NGINX modules should be installed.","descriptions":[{"label":"default","data":"The required NGINX modules should be installed."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{},"code":"  control 'nginx-modules' do\n    impact 0.5\n  end\n","source_location":{"line":10,"ref":"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb"},"waiver_data":{},"results":[]}],"status":"loaded","status_message":""},{"name":"my_nginx","version":"0.1.0","sha256":"d914de3f08e03143aa60de60fb4e981855d30dcaaf659bceefd1234cb5331bcc","title":"InSpec Profile","maintainer":"The Authors","summary":"An InSpec Compliance Profile","license":"Apache-2.0","copyright":"The Authors","copyright_email":"you@example.com","supports":[{"platform":"os"}],"attributes":[{"name":"nginx_version","options":{"type":"String","value":"1.10.3"}},{"name":"nginx_modules","options":{"type":"Array","value":["http_ssl","stream_ssl","mail_ssl"]}},{"name":"admin_users","options":{"type":"Array","value":["admin"]}}],"parent_profile":"my_nginx_overlay","groups":[{"id":"controls/example.rb","controls":["nginx-version","nginx-modules"]}],"controls":[{"id":"nginx-version","title":"NGINX version","desc":"The required version of NGINX should be installed.","descriptions":[{"label":"default","data":"The required version of NGINX should be installed."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-version' do\n  impact 1.0\n  title 'NGINX version'\n  desc 'The required version of NGINX should be installed.'\n  describe nginx do\n    its('version') { should cmp >= input('nginx_version') }\n  end\nend\n","source_location":{"line":1,"ref":"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment version is expected to cmp >= \"1.10.3\"","run_time":0.000614791,"start_time":"2023-02-09T17:49:47+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"}]},{"id":"nginx-modules","title":"NGINX modules","desc":"The required NGINX modules should be installed.","descriptions":[{"label":"default","data":"The required NGINX modules should be installed."}],"impact":0.5,"refs":[{"ref":[]}],"tags":{},"code":"control 'nginx-modules' do\n  impact 1.0\n  title 'NGINX modules'\n  desc 'The required NGINX modules should be installed.'\n  nginx_module_set = input('nginx_modules')\n  describe nginx do\n    nginx_module_set.each do |current_module|\n      its('modules') { should include current_module }\n  end\nend\n\ncontrol 'nginx-shell-access' do\n  impact 1.0\n  title 'NGINX shell access'\n  ndesc 'The NGINX shell access should be restricted to admin users.'\n  describe users.shells(/bash/).usernames do\n    it { should be_in input('admin_users')}\n    end\n  end\nend\n","source_location":{"line":10,"ref":"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"http_ssl\"","run_time":0.00422414,"start_time":"2023-02-09T17:49:47+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"stream_ssl\"","run_time":0.000132798,"start_time":"2023-02-09T17:49:47+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"mail_ssl\"","run_time":0.000189997,"start_time":"2023-02-09T17:49:47+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"},{"status":"failed","code_desc":"Control Source Code Error /workspaces/saf-training-lab-environment./my_nginx/controls/example.rb:10 ","run_time":0.000362095,"start_time":"2023-02-09T17:49:47+00:00","message":"undefined method `control' for #<Inspec::Rule:0x00007fc17e80b320 @impact=0.5, @title=\"NGINX modules\", @descriptions={:default=>\"The required NGINX modules should be installed.\"}, @refs=[{:ref=>[]}], @tags={}, @resource_dsl=#<Module:0x00007fc180a3de48>, @__code=nil, @__block=#<Proc:0x00007fc17e80b208 /workspaces/saf-training-lab-environment./my_nginx/controls/example.rb:10>, @__source_location={:ref=>\"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb\", :line=>10}, @__rule_id=\"nginx-modules\", @__profile_id=\"my_nginx\", @__checks=[[\"describe\", [#<#<Class:0x00007fc1816679d0>:0x00007fc17e809e08 @resource_skipped=false, @resource_failed=false, @supports=[{:platform=>\"unix\"}], @resource_exception_message=nil, @__backend_runner__=Inspec::Backend::Class @transport=Train::Transports::Docker::Connection, @__resource_name__=:nginx, @resource_params=[], @nginx_path=\"/usr/sbin/nginx\", @data=\"nginx version: nginx/1.23.3\\nbuilt by gcc 10.2.1 20210110 (Debian 10.2.1-6) \\nbuilt with OpenSSL 1.1.1n  15 Mar 2022\\nTLS SNI support enabled\\nconfigure arguments: --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-compat --with-file-aio --with-threads --with-http_addition_module --with-http_auth_request_module --with-http_dav_module --with-http_flv_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_mp4_module --with-http_random_index_module --with-http_realip_module --with-http_secure_link_module --with-http_slice_module --with-http_ssl_module --with-http_stub_status_module --with-http_sub_module --with-http_v2_module --with-mail --with-mail_ssl_module --with-stream --with-stream_realip_module --with-stream_ssl_module --with-stream_ssl_preread_module --with-cc-opt='-g -O2 -ffile-prefix-map=/data/builder/debuild/nginx-1.23.3/debian/debuild-base/nginx-1.23.3=. -fstack-protector-strong -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fPIC' --with-ld-opt='-Wl,-z,relro -Wl,-z,now -Wl,--as-needed -pie'\\n\", @params={:prefix=>\"/etc/nginx\", :service=>\"nginx\", :version=>\"1.23.3\", :sbin_path=>\"/usr/sbin/nginx\", :modules_path=>\"/usr/lib/nginx/modules\", :error_log_path=>\"/var/log/nginx/error.log\", :http_log_path=>\"/var/log/nginx/access.log\", :lock_path=>\"/var/run/nginx.lock\", :http_client_body_temp_path=>\"/var/cache/nginx/client_temp\", :http_proxy_temp_path=>\"/var/cache/nginx/proxy_temp\", :http_fastcgi_temp_path=>\"/var/cache/nginx/fastcgi_temp\", :http_uwsgi_temp_path=>\"/var/cache/nginx/uwsgi_temp\", :http_scgi_temp_path=>\"/var/cache/nginx/scgi_temp\"}>], #<Proc:0x00007fc17e80db20 /opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/rule.rb:444>], [\"describe\", [\"Control Source Code Error\"], #<Proc:0x00007fc17e8354e0 /opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/rule.rb:444>]], @__skip_rule={}, @__merge_count=1, @__merge_changes=[{:ref=>\"my_nginx_overlay/controls/overlay.rb\", :line=>2}], @__skip_only_if_eval=false, @__na_rule={}, @__file=\"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb\", @__group_title=nil>","exception":"RuntimeError","backtrace":["/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/rule.rb:64:in `block (2 levels) in initialize'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example.rb:263:in `instance_exec'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example.rb:263:in `block in run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/hooks.rb:486:in `block in run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/hooks.rb:486:in `run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example.rb:259:in `run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example_group.rb:642:in `map'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example_group.rb:642:in `run_examples'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example_group.rb:607:in `run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example_group.rb:608:in `block in run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example_group.rb:608:in `map'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/example_group.rb:608:in `run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/runner.rb:121:in `map'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/configuration.rb:2068:in `with_suite_hooks'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/runner.rb:116:in `block in run_specs'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/reporter.rb:74:in `report'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.11.0/lib/rspec/core/runner.rb:115:in `run_specs'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/runner_rspec.rb:97:in `run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/runner.rb:193:in `run_tests'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/runner.rb:164:in `run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/cli.rb:366:in `exec'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.1/lib/thor/command.rb:27:in `run'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.1/lib/thor/invocation.rb:127:in `invoke_command'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.1/lib/thor.rb:392:in `dispatch'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.1/lib/thor/base.rb:485:in `start'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-5.21.29/lib/inspec/base_cli.rb:35:in `start'","/opt/inspec/embedded/lib/ruby/gems/3.1.0/gems/inspec-bin-5.21.29/bin/inspec:11:in `<top (required)>'","/usr/bin/inspec:258:in `load'","/usr/bin/inspec:258:in `<main>'"],"resource_class":"Object","resource_params":"[]","resource_id":"/workspaces/saf-training-lab-environment./my_nginx/controls/example.rb:10"}]}],"status":"loaded","status_message":""}],"statistics":{"duration":0.011967233},"version":"5.21.29"}